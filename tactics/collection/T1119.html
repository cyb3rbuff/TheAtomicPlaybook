

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>T1119 - Automated Collection &#8212; The Atomic Playbook</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="T1560.003 - Archive via Custom Method" href="T1560.003.html" />
    <link rel="prev" title="T1039 - Data from Network Shared Drive" href="T1039.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">The Atomic Playbook</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to the Atomic Playbook
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../initial-access.html">
   Initial Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../execution.html">
   Execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../persistence.html">
   Persistence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../privilege-escalation.html">
   Privilege Escalation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../defense-evasion.html">
   Defense Evasion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../credential-access.html">
   Credential Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../discovery.html">
   Discovery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lateral-movement.html">
   Lateral Movement
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../collection.html">
   Collection
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="T1056.001.html">
     T1056.001 - Input Capture: Keylogging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1074.html">
     T1074 - Data Staged
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1074.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1113.html">
     T1113 - Screen Capture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1113.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1056.003.html">
     T1056.003 - Web Portal Capture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1056.html">
     T1056 - Input Capture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1056.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1115.html">
     T1115 - Clipboard Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1115.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1213.html">
     T1213 - Data from Information Repositories
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1213.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1056.002.html">
     T1056.002 - Input Capture: GUI Input Capture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1560.html">
     T1560 - Archive Collected Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1560.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1114.html">
     T1114 - Email Collection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1114.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1056.004.html">
     T1056.004 - Input Capture: Credential API Hooking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1557.001.html">
     T1557.001 - LLMNR/NBT-NS Poisoning and SMB Relay
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1557.html">
     T1557 - Man-in-the-Middle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1557.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1074.002.html">
     T1074.002 - Remote Data Staging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1005.html">
     T1005 - Data from Local System
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1005.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1125.html">
     T1125 - Video Capture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1125.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1530.html">
     T1530 - Data from Cloud Storage Object
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1530.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1114.001.html">
     T1114.001 - Email Collection: Local Email Collection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1025.html">
     T1025 - Data from Removable Media
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1025.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1213.001.html">
     T1213.001 - Confluence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1123.html">
     T1123 - Audio Capture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1123.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1114.003.html">
     T1114.003 - Email Forwarding Rule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1560.002.html">
     T1560.002 - Archive via Library
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1185.html">
     T1185 - Man in the Browser
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1185.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1074.001.html">
     T1074.001 - Data Staged: Local Data Staging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1039.html">
     T1039 - Data from Network Shared Drive
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1039.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     T1119 - Automated Collection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1560.003.html">
     T1560.003 - Archive via Custom Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1114.002.html">
     T1114.002 - Remote Email Collection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1560.001.html">
     T1560.001 - Archive Collected Data: Archive via Utility
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1213.002.html">
     T1213.002 - Sharepoint
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../command-and-control.html">
   Command and Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exfiltration.html">
   Exfiltration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../impact.html">
   Impact
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/tactics/collection/T1119.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atomic-tests">
   Atomic Tests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-1-automated-collection-command-prompt">
     Atomic Test #1 - Automated Collection Command Prompt
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-command-prompt">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         command_prompt
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-2-automated-collection-powershell">
     Atomic Test #2 - Automated Collection PowerShell
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-powershell">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-3-recon-information-for-export-with-powershell">
     Atomic Test #3 - Recon information for export with PowerShell
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-4-recon-information-for-export-with-command-prompt">
     Atomic Test #4 - Recon information for export with Command Prompt
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         command_prompt
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detection">
   Detection
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="t1119-automated-collection">
<h1>T1119 - Automated Collection<a class="headerlink" href="#t1119-automated-collection" title="Permalink to this headline">¶</a></h1>
<p>Once established within a system or network, an adversary may use automated techniques for collecting internal data. Methods for performing this technique could include use of a <a class="reference external" href="https://attack.mitre.org/techniques/T1059">Command and Scripting Interpreter</a> to search for and copy information fitting set criteria such as file type, location, or name at specific time intervals. This functionality could also be built into remote access tools.</p>
<p>This technique may incorporate use of other techniques such as <a class="reference external" href="https://attack.mitre.org/techniques/T1083">File and Directory Discovery</a> and <a class="reference external" href="https://attack.mitre.org/techniques/T1570">Lateral Tool Transfer</a> to identify and move files.</p>
<div class="section" id="atomic-tests">
<h2>Atomic Tests<a class="headerlink" href="#atomic-tests" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the Module before running the tests.</span>
<span class="c1"># Checkout Jupyter Notebook at https://github.com/haresudhan/TheAtomicPlaybook to run PS scripts.</span>
<span class="n">Import</span><span class="o">-</span><span class="n">Module</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="mh">0x6c</span><span class="o">/</span><span class="n">AtomicRedTeam</span><span class="o">/</span><span class="n">atomics</span><span class="o">/</span><span class="n">invoke</span><span class="o">-</span><span class="n">atomicredteam</span><span class="o">/</span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicRedTeam</span><span class="o">.</span><span class="n">psd1</span> <span class="o">-</span> <span class="n">Force</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="atomic-test-1-automated-collection-command-prompt">
<h3>Atomic Test #1 - Automated Collection Command Prompt<a class="headerlink" href="#atomic-test-1-automated-collection-command-prompt" title="Permalink to this headline">¶</a></h3>
<p>Automated Collection. Upon execution, check the users temp directory (%temp%) for the folder T1119_command_prompt_collection
to see what was collected.</p>
<p><strong>Supported Platforms:</strong> windows</p>
<div class="section" id="attack-commands-run-with-command-prompt">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code><a class="headerlink" href="#attack-commands-run-with-command-prompt" title="Permalink to this headline">¶</a></h4>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>mkdir %temp%\T1119_command_prompt_collection &gt;nul 2&gt;&amp;1
dir c: /b /s .docx | findstr /e .docx
for /R c: %f in (*.docx) do copy %f %temp%\T1119_command_prompt_collection
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1119</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-2-automated-collection-powershell">
<h3>Atomic Test #2 - Automated Collection PowerShell<a class="headerlink" href="#atomic-test-2-automated-collection-powershell" title="Permalink to this headline">¶</a></h3>
<p>Automated Collection. Upon execution, check the users temp directory (%temp%) for the folder T1119_powershell_collection
to see what was collected.</p>
<p><strong>Supported Platforms:</strong> windows</p>
<div class="section" id="attack-commands-run-with-powershell">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#attack-commands-run-with-powershell" title="Permalink to this headline">¶</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-Item</span> <span class="n">-Path</span> <span class="nv">$env:TEMP</span><span class="p">\</span><span class="n">T1119_powershell_collection</span> <span class="n">-ItemType</span> <span class="n">Directory</span> <span class="n">-Force</span> <span class="p">|</span> <span class="nb">Out-Null</span>
<span class="nb">Get-ChildItem</span> <span class="n">-Recurse</span> <span class="n">-Include</span> <span class="p">*.</span><span class="n">doc</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span><span class="nb">Copy-Item</span> <span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span> <span class="n">-destination</span> <span class="nv">$env:TEMP</span><span class="p">\</span><span class="n">T1119_powershell_collection</span><span class="p">}</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1119</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-3-recon-information-for-export-with-powershell">
<h3>Atomic Test #3 - Recon information for export with PowerShell<a class="headerlink" href="#atomic-test-3-recon-information-for-export-with-powershell" title="Permalink to this headline">¶</a></h3>
<p>collect information for exfiltration. Upon execution, check the users temp directory (%temp%) for files T1119_*.txt
to see what was collected.</p>
<p><strong>Supported Platforms:</strong> windows</p>
<div class="section" id="id1">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span>Get-Service &gt; $env:TEMP\T1119_1.txt
Get-ChildItem Env: &gt; $env:TEMP\T1119_2.txt
Get-Process &gt; $env:TEMP\T1119_3.txt
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1119</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-4-recon-information-for-export-with-command-prompt">
<h3>Atomic Test #4 - Recon information for export with Command Prompt<a class="headerlink" href="#atomic-test-4-recon-information-for-export-with-command-prompt" title="Permalink to this headline">¶</a></h3>
<p>collect information for exfiltration. Upon execution, check the users temp directory (%temp%) for files T1119_*.txt
to see what was collected.</p>
<p><strong>Supported Platforms:</strong> windows</p>
<div class="section" id="id2">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>sc query type=service &gt; %TEMP%\T1119_1.txt
doskey /history &gt; %TEMP%\T1119_2.txt
wmic process list &gt; %TEMP%\T1119_3.txt
tree C:\AtomicRedTeam\atomics &gt; %TEMP%\T1119_4.txt
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1119</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="detection">
<h2>Detection<a class="headerlink" href="#detection" title="Permalink to this headline">¶</a></h2>
<p>Depending on the method used, actions could include common file system commands and parameters on the command-line interface within batch files or scripts. A sequence of actions like this may be unusual, depending on the system and network environment. Automated collection may occur along with other techniques such as <a class="reference external" href="https://attack.mitre.org/techniques/T1074">Data Staged</a>. As such, file access monitoring that shows an unusual process performing sequential file opens and potentially copy actions to another location on the file system for many files at once may indicate automated collection behavior. Remote access tools with built-in features may interact directly with the Windows API to gather data. Data may also be acquired through Windows system management tools such as <a class="reference external" href="https://attack.mitre.org/techniques/T1047">Windows Management Instrumentation</a> and <a class="reference external" href="https://attack.mitre.org/techniques/T1059/001">PowerShell</a>.</p>
</div>
</div>
<div class="section" id="shield-active-defense">
<h1>Shield Active Defense<a class="headerlink" href="#shield-active-defense" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pocket-litter">
<h2>Pocket Litter<a class="headerlink" href="#pocket-litter" title="Permalink to this headline">¶</a></h2>
<p>Place data on a system to reinforce the legitimacy of the system or user.</p>
<p>Pocket Litter is data placed on a system to convince an adversary that the system and users are real.  Pocket litter includes documents, registry entries, log history, browsing history, connection history, and other user data that one would expect to exist on a user’s computer.  This content may overlap with Decoy Content, however Pocket Litter covers aspects beyond just content (e.g.: Installed Applications, source code, clutter on a system, etc.).</p>
<div class="section" id="opportunity">
<h3>Opportunity<a class="headerlink" href="#opportunity" title="Permalink to this headline">¶</a></h3>
<p>In an adversary engagement scenario, there is an opportunity to seed content to influence an adversary’s behaviors, test their interest in specific topics, or add legitimacy to a system or environment.</p>
</div>
<div class="section" id="use-case">
<h3>Use Case<a class="headerlink" href="#use-case" title="Permalink to this headline">¶</a></h3>
<p>A defender can stage a variety of pocket litter files to see if the adversary collect any of those files in an automated manner.</p>
</div>
<div class="section" id="procedures">
<h3>Procedures<a class="headerlink" href="#procedures" title="Permalink to this headline">¶</a></h3>
<p>When staging a decoy system and user account, populate a user’s folders and web history to make it look realistic to an adversary.
Stage a USB device with documents on a specific topic in order to see if they are exfiltrated by an adversary.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ".net-powershell"
        },
        kernelOptions: {
            kernelName: ".net-powershell",
            path: "./tactics/collection"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = '.net-powershell'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="T1039.html" title="previous page">T1039 - Data from Network Shared Drive</a>
    <a class='right-next' id="next-link" href="T1560.003.html" title="next page">T1560.003 - Archive via Custom Method</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hare Sudhan Muthusamy<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>