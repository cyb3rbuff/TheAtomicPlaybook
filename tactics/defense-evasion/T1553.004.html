

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>T1553.004 - Subvert Trust Controls: Install Root Certificate &#8212; The Atomic Playbook</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="T1574.002 - Hijack Execution Flow: DLL Side-Loading" href="T1574.002.html" />
    <link rel="prev" title="T1218.005 - Signed Binary Proxy Execution: Mshta" href="T1218.005.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">The Atomic Playbook</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to the Atomic Playbook
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../initial-access.html">
   Initial Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../execution.html">
   Execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../persistence.html">
   Persistence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../privilege-escalation.html">
   Privilege Escalation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../defense-evasion.html">
   Defense Evasion
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.002.html">
     T1548.002 - Abuse Elevation Control Mechanism: Bypass User Access Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1108.html">
     T1108 - Redundant Access
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1550.003.html">
     T1550.003 - Use Alternate Authentication Material: Pass the Ticket
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.005.html">
     T1027.005 - Indicator Removal from Tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1578.html">
     T1578 - Modify Cloud Compute Infrastructure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.004.html">
     T1070.004 - Indicator Removal on Host: File Deletion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.006.html">
     T1562.006 - Indicator Blocking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.009.html">
     T1055.009 - Proc Memory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.004.html">
     T1562.004 - Impair Defenses: Disable or Modify System Firewall
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.011.html">
     T1218.011 - Signed Binary Proxy Execution: Rundll32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.006.html">
     T1070.006 - Indicator Removal on Host: Timestomp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.012.html">
     T1055.012 - Process Injection: Process Hollowing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1550.001.html">
     T1550.001 - Application Access Token
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.002.html">
     T1564.002 - Hide Artifacts: Hidden Users
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1222.001.html">
     T1222.001 - File and Directory Permissions Modification: Windows File and Directory Permissions Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.008.html">
     T1218.008 - Signed Binary Proxy Execution: Odbcconf
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.003.html">
     T1027.003 - Steganography
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.012.html">
     T1574.012 - Hijack Execution Flow: COR_PROFILER
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.004.html">
     T1548.004 - Elevated Execution with Prompt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.006.html">
     T1564.006 - Run Virtual Instance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1542.003.html">
     T1542.003 - Bootkit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.002.html">
     T1070.002 - Indicator Removal on Host: Clear Linux or Mac System Logs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1556.003.html">
     T1556.003 - Pluggable Authentication Modules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1216.html">
     T1216 - Signed Script Proxy Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1556.001.html">
     T1556.001 - Domain Controller Authentication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.009.html">
     T1574.009 - Hijack Execution Flow: Path Interception by Unquoted Path
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.002.html">
     T1497.002 - User Activity Based Checks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1542.001.html">
     T1542.001 - System Firmware
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.002.html">
     T1562.002 - Impair Defenses: Disable Windows Event Logging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.html">
     T1070 - Indicator Removal on Host
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1149.html">
     T1149 - LC_MAIN Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.004.html">
     T1564.004 - Hide Artifacts: NTFS File Attributes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1205.001.html">
     T1205.001 - Port Knocking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.001.html">
     T1027.001 - Obfuscated Files or Information: Binary Padding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.010.html">
     T1574.010 - Hijack Execution Flow: Services File Permissions Weakness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.014.html">
     T1055.014 - VDSO Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.010.html">
     T1218.010 - Signed Binary Proxy Execution: Regsvr32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1112.html">
     T1112 - Modify Registry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1197.html">
     T1197 - BITS Jobs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.html">
     T1562 - Impair Defenses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.009.html">
     T1218.009 - Signed Binary Proxy Execution: Regsvcs/Regasm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.001.html">
     T1548.001 - Abuse Elevation Control Mechanism: Setuid and Setgid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.003.html">
     T1564.003 - Hide Artifacts: Hidden Window
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.013.html">
     T1055.013 - Process Doppelgänging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.004.html">
     T1027.004 - Obfuscated Files or Information: Compile After Delivery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1216.001.html">
     T1216.001 - Signed Script Proxy Execution: Pubprn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1550.002.html">
     T1550.002 - Use Alternate Authentication Material: Pass the Hash
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.011.html">
     T1055.011 - Extra Window Memory Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.html">
     T1134 - Access Token Manipulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1222.002.html">
     T1222.002 - File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1014.html">
     T1014 - Rootkit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.003.html">
     T1548.003 - Abuse Elevation Control Mechanism: Sudo and Sudo Caching
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.001.html">
     T1564.001 - Hide Artifacts: Hidden Files and Directories
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1480.html">
     T1480 - Execution Guardrails
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.008.html">
     T1055.008 - Ptrace System Calls
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.007.html">
     T1562.007 - Disable or Modify Cloud Firewall
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.005.html">
     T1070.005 - Indicator Removal on Host: Network Share Connection Removal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1211.html">
     T1211 - Exploitation for Defense Evasion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.003.html">
     T1562.003 - Impair Defenses: HISTCONTROL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.008.html">
     T1574.008 - Path Interception by Search Order Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.003.html">
     T1497.003 - Time Based Evasion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.001.html">
     T1070.001 - Indicator Removal on Host: Clear Windows Event Logs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.011.html">
     T1574.011 - Hijack Execution Flow: Services Registry Permissions Weakness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.html">
     T1055 - Process Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1484.html">
     T1484 - Group Policy Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.005.html">
     T1564.005 - Hidden File System
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.html">
     T1564 - Hide Artifacts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1550.004.html">
     T1550.004 - Web Session Cookie
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.002.html">
     T1027.002 - Obfuscated Files or Information: Software Packing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1556.002.html">
     T1556.002 - Modify Authentication Process: Password Filter DLL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.003.html">
     T1070.003 - Indicator Removal on Host: Clear Command History
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.html">
     T1036 - Masquerading
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.001.html">
     T1562.001 - Impair Defenses: Disable or Modify Tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1542.html">
     T1542 - Pre-OS Boot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1542.002.html">
     T1542.002 - Component Firmware
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.001.html">
     T1497.001 - System Checks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1127.html">
     T1127 - Trusted Developer Utilities Proxy Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.002.html">
     T1055.002 - Portable Executable Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.006.html">
     T1574.006 - Hijack Execution Flow: LD_PRELOAD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.004.html">
     T1134.004 - Access Token Manipulation: Parent PID Spoofing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1127.001.html">
     T1127.001 - Trusted Developer Utilities Proxy Execution: MSBuild
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.003.html">
     T1078.003 - Local Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.001.html">
     T1218.001 - Signed Binary Proxy Execution: Compiled HTML File
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1202.html">
     T1202 - Indirect Command Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.001.html">
     T1078.001 - Valid Accounts: Default Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.003.html">
     T1218.003 - Signed Binary Proxy Execution: CMSTP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1064.html">
     T1064 - Scripting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.002.html">
     T1036.002 - Right-to-Left Override
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1553.002.html">
     T1553.002 - Code Signing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.004.html">
     T1574.004 - Dylib Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.html">
     T1548 - Abuse Elevation Control Mechanism
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1220.html">
     T1220 - XSL Script Processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.002.html">
     T1134.002 - Create Process with Token
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.004.html">
     T1055.004 - Process Injection: Asynchronous Procedure Call
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1578.001.html">
     T1578.001 - Create Snapshot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1140.html">
     T1140 - Deobfuscate/Decode Files or Information
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.007.html">
     T1218.007 - Signed Binary Proxy Execution: Msiexec
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.006.html">
     T1036.006 - Masquerading: Space after Filename
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.004.html">
     T1036.004 - Masquerade Task or Service
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.html">
     T1027 - Obfuscated Files or Information
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1553.html">
     T1553 - Subvert Trust Controls
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1480.001.html">
     T1480.001 - Environmental Keying
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.005.html">
     T1218.005 - Signed Binary Proxy Execution: Mshta
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     T1553.004 - Subvert Trust Controls: Install Root Certificate
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.002.html">
     T1574.002 - Hijack Execution Flow: DLL Side-Loading
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1222.html">
     T1222 - File and Directory Permissions Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1578.003.html">
     T1578.003 - Delete Cloud Instance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.html">
     T1497 - Virtualization/Sandbox Evasion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.003.html">
     T1036.003 - Masquerading: Rename System Utilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.002.html">
     T1218.002 - Signed Binary Proxy Execution: Control Panel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1553.003.html">
     T1553.003 - SIP and Trust Provider Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.001.html">
     T1055.001 - Dynamic-link Library Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.005.html">
     T1574.005 - Executable Installer File Permissions Weakness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1578.004.html">
     T1578.004 - Revert Cloud Instance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1535.html">
     T1535 - Unused/Unsupported Cloud Regions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.html">
     T1218 - Signed Binary Proxy Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1006.html">
     T1006 - Direct Volume Access
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1553.001.html">
     T1553.001 - Subvert Trust Controls: Gatekeeper Bypass
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.003.html">
     T1055.003 - Thread Execution Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.007.html">
     T1574.007 - Path Interception by PATH Environment Variable
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.005.html">
     T1134.005 - SID-History Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.002.html">
     T1078.002 - Domain Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.001.html">
     T1036.001 - Invalid Code Signature
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1556.html">
     T1556 - Modify Authentication Process
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1207.html">
     T1207 - Rogue Domain Controller
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.004.html">
     T1218.004 - Signed Binary Proxy Execution: InstallUtil
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.005.html">
     T1036.005 - Match Legitimate Name or Location
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1578.002.html">
     T1578.002 - Create Cloud Instance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.001.html">
     T1134.001 - Token Impersonation/Theft
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.html">
     T1078 - Valid Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1221.html">
     T1221 - Template Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.003.html">
     T1134.003 - Make and Impersonate Token
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.005.html">
     T1055.005 - Thread Local Storage
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.001.html">
     T1574.001 - Hijack Execution Flow: DLL Search Order Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.html">
     T1574 - Hijack Execution Flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1550.html">
     T1550 - Use Alternate Authentication Material
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.004.html">
     T1078.004 - Cloud Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1205.html">
     T1205 - Traffic Signaling
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../credential-access.html">
   Credential Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../discovery.html">
   Discovery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lateral-movement.html">
   Lateral Movement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../collection.html">
   Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../command-and-control.html">
   Command and Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exfiltration.html">
   Exfiltration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../impact.html">
   Impact
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/tactics/defense-evasion/T1553.004.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atomic-tests">
   Atomic Tests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-1-install-root-ca-on-centos-rhel">
     Atomic Test #1 - Install root CA on CentOS/RHEL
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-sh">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         sh
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-2-install-root-ca-on-debian-ubuntu">
     Atomic Test #2 - Install root CA on Debian/Ubuntu
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dependencies-run-with-command-prompt">
       Dependencies:  Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         command_prompt
        </span>
       </code>
       !
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#description-verify-the-certificate-exists-it-generates-if-not-on-disk">
         Description: Verify the certificate exists. It generates if not on disk.
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#check-prereq-commands">
         Check Prereq Commands:
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#get-prereq-commands">
         Get Prereq Commands:
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         sh
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-3-install-root-ca-on-macos">
     Atomic Test #3 - Install root CA on macOS
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Dependencies:  Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         command_prompt
        </span>
       </code>
       !
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id3">
         Description: Verify the certificate exists. It generates if not on disk.
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id4">
         Check Prereq Commands:
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id5">
         Get Prereq Commands:
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-command-prompt">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         command_prompt
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-4-install-root-ca-on-windows">
     Atomic Test #4 - Install root CA on Windows
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dependencies-run-with-powershell">
       Dependencies:  Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
       !
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id6">
         Description: Verify the certificate exists. It generates if not on disk.
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id7">
         Check Prereq Commands:
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id8">
         Get Prereq Commands:
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-powershell">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detection">
   Detection
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="t1553-004-subvert-trust-controls-install-root-certificate">
<h1>T1553.004 - Subvert Trust Controls: Install Root Certificate<a class="headerlink" href="#t1553-004-subvert-trust-controls-install-root-certificate" title="Permalink to this headline">¶</a></h1>
<p>Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers. Root certificates are used in public key cryptography to identify a root certificate authority (CA). When a root certificate is installed, the system or application will trust certificates in the root’s chain of trust that have been signed by the root certificate. (Citation: Wikipedia Root Certificate) Certificates are commonly used for establishing secure TLS/SSL communications within a web browser. When a user attempts to browse a website that presents a certificate that is not trusted an error message will be displayed to warn the user of the security risk. Depending on the security settings, the browser may not allow the user to establish a connection to the website.</p>
<p>Installation of a root certificate on a compromised system would give an adversary a way to degrade the security of that system. Adversaries have used this technique to avoid security warnings prompting users when compromised systems connect over HTTPS to adversary controlled web servers that spoof legitimate websites in order to collect login credentials. (Citation: Operation Emmental)</p>
<p>Atypical root certificates have also been pre-installed on systems by the manufacturer or in the software supply chain and were used in conjunction with malware/adware to provide a man-in-the-middle capability for intercepting information transmitted over secure TLS/SSL communications. (Citation: Kaspersky Superfish)</p>
<p>Root certificates (and their associated chains) can also be cloned and reinstalled. Cloned certificate chains will carry many of the same metadata characteristics of the source and can be used to sign malicious code that may then bypass signature validation tools (ex: Sysinternals, antivirus, etc.) used to block execution and/or uncover artifacts of Persistence. (Citation: SpectorOps Code Signing Dec 2017)</p>
<p>In macOS, the Ay MaMi malware uses <code>/usr/bin/security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /path/to/malicious/cert</code> to install a malicious certificate as a trusted root certificate into the system keychain. (Citation: objective-see ay mami 2018)</p>
<div class="section" id="atomic-tests">
<h2>Atomic Tests<a class="headerlink" href="#atomic-tests" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the Module before running the tests.</span>
<span class="n">Import</span><span class="o">-</span><span class="n">Module</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="mh">0x6c</span><span class="o">/</span><span class="n">AtomicRedTeam</span><span class="o">/</span><span class="n">atomics</span><span class="o">/</span><span class="n">invoke</span><span class="o">-</span><span class="n">atomicredteam</span><span class="o">/</span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicRedTeam</span><span class="o">.</span><span class="n">psd1</span> <span class="o">-</span> <span class="n">Force</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="atomic-test-1-install-root-ca-on-centos-rhel">
<h3>Atomic Test #1 - Install root CA on CentOS/RHEL<a class="headerlink" href="#atomic-test-1-install-root-ca-on-centos-rhel" title="Permalink to this headline">¶</a></h3>
<p>Creates a root CA with openssl</p>
<p><strong>Supported Platforms:</strong> linux</p>
<div class="section" id="attack-commands-run-with-sh">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code><a class="headerlink" href="#attack-commands-run-with-sh" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>openssl genrsa -out rootCA.key <span class="m">4096</span>
openssl req -x509 -new -nodes -key rootCA.key -sha256 -days <span class="m">365</span> -subj <span class="s2">&quot;/C=US/ST=Denial/L=Springfield/O=Dis/CN=www.example.com&quot;</span> -out rootCA.crt

<span class="k">if</span> <span class="o">[</span> <span class="k">$(</span>rpm -q --queryformat <span class="s1">&#39;%{VERSION}&#39;</span> centos-release<span class="k">)</span> -le <span class="s2">&quot;5&quot;</span> <span class="o">]</span><span class="p">;</span>
<span class="k">then</span>
  cat rootCA.crt &gt;&gt; /etc/pki/tls/certs/ca-bundle.crt
<span class="k">else</span> <span class="k">if</span> <span class="o">[</span> <span class="k">$(</span>rpm -q --queryformat <span class="s1">&#39;%{VERSION}&#39;</span> centos-release<span class="k">)</span> -ge <span class="s2">&quot;7&quot;</span> <span class="o">]</span><span class="p">;</span>
  cp rootCA.crt /etc/pki/ca-trust/source/anchors/
  update-ca-trust
<span class="k">fi</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1553</span><span class="o">.</span><span class="mi">004</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-2-install-root-ca-on-debian-ubuntu">
<h3>Atomic Test #2 - Install root CA on Debian/Ubuntu<a class="headerlink" href="#atomic-test-2-install-root-ca-on-debian-ubuntu" title="Permalink to this headline">¶</a></h3>
<p>Creates a root CA with openssl</p>
<p><strong>Supported Platforms:</strong> linux
Elevation Required (e.g. root or admin)</p>
<div class="section" id="dependencies-run-with-command-prompt">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code>!<a class="headerlink" href="#dependencies-run-with-command-prompt" title="Permalink to this headline">¶</a></h4>
<div class="section" id="description-verify-the-certificate-exists-it-generates-if-not-on-disk">
<h5>Description: Verify the certificate exists. It generates if not on disk.<a class="headerlink" href="#description-verify-the-certificate-exists-it-generates-if-not-on-disk" title="Permalink to this headline">¶</a></h5>
</div>
<div class="section" id="check-prereq-commands">
<h5>Check Prereq Commands:<a class="headerlink" href="#check-prereq-commands" title="Permalink to this headline">¶</a></h5>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>if [ -f rootCA.crt ]; then exit 0; else exit 1; fi;

</pre></div>
</div>
</div>
<div class="section" id="get-prereq-commands">
<h5>Get Prereq Commands:<a class="headerlink" href="#get-prereq-commands" title="Permalink to this headline">¶</a></h5>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>if [ ! -f rootCA.key ]; then openssl genrsa -out rootCA.key 4096; fi;
openssl req -x509 -new -nodes -key rootCA.key -sha256 -days 365 -subj &quot;/C=US/ST=Denial/L=Springfield/O=Dis/CN=www.example.com&quot; -out rootCA.crt

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1553</span><span class="o">.</span><span class="mi">004</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">2</span> <span class="o">-</span><span class="n">GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mv rootCA.crt /usr/local/share/ca-certificates
<span class="nb">echo</span> sudo update-ca-certificates
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1553</span><span class="o">.</span><span class="mi">004</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-3-install-root-ca-on-macos">
<h3>Atomic Test #3 - Install root CA on macOS<a class="headerlink" href="#atomic-test-3-install-root-ca-on-macos" title="Permalink to this headline">¶</a></h3>
<p>Creates a root CA with openssl</p>
<p><strong>Supported Platforms:</strong> macos
Elevation Required (e.g. root or admin)</p>
<div class="section" id="id2">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code>!<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id3">
<h5>Description: Verify the certificate exists. It generates if not on disk.<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
</div>
<div class="section" id="id4">
<h5>Check Prereq Commands:<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h5>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>if [ -f rootCA.crt ]; then exit 0; else exit 1; fi;

</pre></div>
</div>
</div>
<div class="section" id="id5">
<h5>Get Prereq Commands:<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h5>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>if [ ! -f rootCA.key ]; then openssl genrsa -out rootCA.key 4096; fi;
openssl req -x509 -new -nodes -key rootCA.key -sha256 -days 365 -subj &quot;/C=US/ST=Denial/L=Springfield/O=Dis/CN=www.example.com&quot; -out rootCA.crt

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1553</span><span class="o">.</span><span class="mi">004</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">3</span> <span class="o">-</span><span class="n">GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="attack-commands-run-with-command-prompt">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code><a class="headerlink" href="#attack-commands-run-with-command-prompt" title="Permalink to this headline">¶</a></h4>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>sudo security add-trusted-cert -d -r trustRoot -k &quot;/Library/Keychains/System.keychain&quot; &quot;rootCA.crt&quot;
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1553</span><span class="o">.</span><span class="mi">004</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-4-install-root-ca-on-windows">
<h3>Atomic Test #4 - Install root CA on Windows<a class="headerlink" href="#atomic-test-4-install-root-ca-on-windows" title="Permalink to this headline">¶</a></h3>
<p>Creates a root CA with Powershell</p>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)</p>
<div class="section" id="dependencies-run-with-powershell">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!<a class="headerlink" href="#dependencies-run-with-powershell" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id6">
<h5>Description: Verify the certificate exists. It generates if not on disk.<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h5>
</div>
<div class="section" id="id7">
<h5>Check Prereq Commands:<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">rootCA</span><span class="p">.</span><span class="n">cer</span><span class="p">)</span> <span class="p">{</span> <span class="n">exit</span> <span class="n">0</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="n">exit</span> <span class="n">1</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h5>Get Prereq Commands:<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span>$cert = New-SelfSignedCertificate -DnsName atomicredteam.com -CertStoreLocation cert:\LocalMachine\My
Export-Certificate -Type CERT -Cert  Cert:\LocalMachine\My\$($cert.Thumbprint) -FilePath rootCA.cer
Get-ChildItem Cert:\LocalMachine\My\$($cert.Thumbprint) | Remove-Item

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1553</span><span class="o">.</span><span class="mi">004</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">4</span> <span class="o">-</span><span class="n">GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="attack-commands-run-with-powershell">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#attack-commands-run-with-powershell" title="Permalink to this headline">¶</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span>$cert = Import-Certificate -FilePath rootCA.cer -CertStoreLocation Cert:\LocalMachine\My
Move-Item -Path $cert.PSPath -Destination &quot;Cert:\LocalMachine\Root&quot;
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1553</span><span class="o">.</span><span class="mi">004</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="detection">
<h2>Detection<a class="headerlink" href="#detection" title="Permalink to this headline">¶</a></h2>
<p>A system’s root certificates are unlikely to change frequently. Monitor new certificates installed on a system that could be due to malicious activity. (Citation: SpectorOps Code Signing Dec 2017) Check pre-installed certificates on new systems to ensure unnecessary or suspicious certificates are not present. Microsoft provides a list of trustworthy root certificates online and through authroot.stl. (Citation: SpectorOps Code Signing Dec 2017) The Sysinternals Sigcheck utility can also be used (<code>sigcheck[64].exe -tuv</code>) to dump the contents of the certificate store and list valid certificates not rooted to the Microsoft Certificate Trust List. (Citation: Microsoft Sigcheck May 2017)</p>
<p>Installed root certificates are located in the Registry under <code>HKLM\SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates&lt;/code&gt; and <code>[HKLM or HKCU]\Software[\Policies]\Microsoft\SystemCertificates\Root\Certificates&lt;/code&gt;. There are a subset of root certificates that are consistent across Windows systems and can be used for comparison: (Citation: Tripwire AppUNBlocker)</p>
<ul class="simple">
<li><p>18F7C1FCC3090203FD5BAA2F861A754976C8DD25</p></li>
<li><p>245C97DF7514E7CF2DF8BE72AE957B9E04741E85</p></li>
<li><p>3B1EFD3A66EA28B16697394703A72CA340A05BD5</p></li>
<li><p>7F88CD7223F3C813818C994614A89C99FA3B5247</p></li>
<li><p>8F43288AD272F3103B6FB1428485EA3014C0BCFE</p></li>
<li><p>A43489159A520F0D93D032CCAF37E7FE20A8B419</p></li>
<li><p>BE36A4562FB2EE05DBB3D32323ADF445084ED656</p></li>
<li><p>CDD4EEAE6000AC7F40C3802C171E30148030C072</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ".net-powershell"
        },
        kernelOptions: {
            kernelName: ".net-powershell",
            path: "./tactics/defense-evasion"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = '.net-powershell'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="T1218.005.html" title="previous page">T1218.005 - Signed Binary Proxy Execution: Mshta</a>
    <a class='right-next' id="next-link" href="T1574.002.html" title="next page">T1574.002 - Hijack Execution Flow: DLL Side-Loading</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hare Sudhan Muthusamy<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>