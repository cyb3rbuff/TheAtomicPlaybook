

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>T1553.003 - SIP and Trust Provider Hijacking &#8212; The Atomic Playbook</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="T1055.001 - Dynamic-link Library Injection" href="T1055.001.html" />
    <link rel="prev" title="T1218.002 - Signed Binary Proxy Execution: Control Panel" href="T1218.002.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">The Atomic Playbook</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to the Atomic Playbook
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../initial-access.html">
   Initial Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../execution.html">
   Execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../persistence.html">
   Persistence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../privilege-escalation.html">
   Privilege Escalation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../defense-evasion.html">
   Defense Evasion
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.002.html">
     T1548.002 - Abuse Elevation Control Mechanism: Bypass User Access Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1108.html">
     T1108 - Redundant Access
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1550.003.html">
     T1550.003 - Use Alternate Authentication Material: Pass the Ticket
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.005.html">
     T1027.005 - Indicator Removal from Tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1578.html">
     T1578 - Modify Cloud Compute Infrastructure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.004.html">
     T1070.004 - Indicator Removal on Host: File Deletion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.006.html">
     T1562.006 - Indicator Blocking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.009.html">
     T1055.009 - Proc Memory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.004.html">
     T1562.004 - Impair Defenses: Disable or Modify System Firewall
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.011.html">
     T1218.011 - Signed Binary Proxy Execution: Rundll32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.006.html">
     T1070.006 - Indicator Removal on Host: Timestomp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.012.html">
     T1055.012 - Process Injection: Process Hollowing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1550.001.html">
     T1550.001 - Application Access Token
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.002.html">
     T1564.002 - Hide Artifacts: Hidden Users
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1222.001.html">
     T1222.001 - File and Directory Permissions Modification: Windows File and Directory Permissions Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.008.html">
     T1218.008 - Signed Binary Proxy Execution: Odbcconf
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.003.html">
     T1027.003 - Steganography
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.012.html">
     T1574.012 - Hijack Execution Flow: COR_PROFILER
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.004.html">
     T1548.004 - Elevated Execution with Prompt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.006.html">
     T1564.006 - Run Virtual Instance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1542.003.html">
     T1542.003 - Bootkit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.002.html">
     T1070.002 - Indicator Removal on Host: Clear Linux or Mac System Logs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1556.003.html">
     T1556.003 - Pluggable Authentication Modules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1216.html">
     T1216 - Signed Script Proxy Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1216.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1556.001.html">
     T1556.001 - Domain Controller Authentication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.009.html">
     T1574.009 - Hijack Execution Flow: Path Interception by Unquoted Path
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.002.html">
     T1497.002 - User Activity Based Checks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1542.001.html">
     T1542.001 - System Firmware
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.002.html">
     T1562.002 - Impair Defenses: Disable Windows Event Logging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.html">
     T1070 - Indicator Removal on Host
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1149.html">
     T1149 - LC_MAIN Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.004.html">
     T1564.004 - Hide Artifacts: NTFS File Attributes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1205.001.html">
     T1205.001 - Port Knocking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.001.html">
     T1027.001 - Obfuscated Files or Information: Binary Padding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.010.html">
     T1574.010 - Hijack Execution Flow: Services File Permissions Weakness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.014.html">
     T1055.014 - VDSO Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.010.html">
     T1218.010 - Signed Binary Proxy Execution: Regsvr32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1112.html">
     T1112 - Modify Registry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1112.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1197.html">
     T1197 - BITS Jobs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1197.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.html">
     T1562 - Impair Defenses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.009.html">
     T1218.009 - Signed Binary Proxy Execution: Regsvcs/Regasm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.001.html">
     T1548.001 - Abuse Elevation Control Mechanism: Setuid and Setgid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.003.html">
     T1564.003 - Hide Artifacts: Hidden Window
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.013.html">
     T1055.013 - Process Doppelgänging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.004.html">
     T1027.004 - Obfuscated Files or Information: Compile After Delivery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1216.001.html">
     T1216.001 - Signed Script Proxy Execution: Pubprn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1550.002.html">
     T1550.002 - Use Alternate Authentication Material: Pass the Hash
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.011.html">
     T1055.011 - Extra Window Memory Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.html">
     T1134 - Access Token Manipulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1222.002.html">
     T1222.002 - File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1014.html">
     T1014 - Rootkit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1014.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.003.html">
     T1548.003 - Abuse Elevation Control Mechanism: Sudo and Sudo Caching
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.001.html">
     T1564.001 - Hide Artifacts: Hidden Files and Directories
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1480.html">
     T1480 - Execution Guardrails
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1480.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.008.html">
     T1055.008 - Ptrace System Calls
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.007.html">
     T1562.007 - Disable or Modify Cloud Firewall
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.005.html">
     T1070.005 - Indicator Removal on Host: Network Share Connection Removal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1211.html">
     T1211 - Exploitation for Defense Evasion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1211.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.003.html">
     T1562.003 - Impair Defenses: HISTCONTROL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.008.html">
     T1574.008 - Path Interception by Search Order Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.003.html">
     T1497.003 - Time Based Evasion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.001.html">
     T1070.001 - Indicator Removal on Host: Clear Windows Event Logs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.011.html">
     T1574.011 - Hijack Execution Flow: Services Registry Permissions Weakness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.html">
     T1055 - Process Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1484.html">
     T1484 - Group Policy Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1484.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.005.html">
     T1564.005 - Hidden File System
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.html">
     T1564 - Hide Artifacts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1564.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1550.004.html">
     T1550.004 - Web Session Cookie
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.002.html">
     T1027.002 - Obfuscated Files or Information: Software Packing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1556.002.html">
     T1556.002 - Modify Authentication Process: Password Filter DLL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1070.003.html">
     T1070.003 - Indicator Removal on Host: Clear Command History
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.html">
     T1036 - Masquerading
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1562.001.html">
     T1562.001 - Impair Defenses: Disable or Modify Tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1542.html">
     T1542 - Pre-OS Boot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1542.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1542.002.html">
     T1542.002 - Component Firmware
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.001.html">
     T1497.001 - System Checks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1127.html">
     T1127 - Trusted Developer Utilities Proxy Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1127.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.002.html">
     T1055.002 - Portable Executable Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.006.html">
     T1574.006 - Hijack Execution Flow: LD_PRELOAD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.004.html">
     T1134.004 - Access Token Manipulation: Parent PID Spoofing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1127.001.html">
     T1127.001 - Trusted Developer Utilities Proxy Execution: MSBuild
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.003.html">
     T1078.003 - Local Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.001.html">
     T1218.001 - Signed Binary Proxy Execution: Compiled HTML File
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1202.html">
     T1202 - Indirect Command Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1202.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.001.html">
     T1078.001 - Valid Accounts: Default Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.003.html">
     T1218.003 - Signed Binary Proxy Execution: CMSTP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1064.html">
     T1064 - Scripting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.002.html">
     T1036.002 - Right-to-Left Override
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1553.002.html">
     T1553.002 - Code Signing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.004.html">
     T1574.004 - Dylib Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.html">
     T1548 - Abuse Elevation Control Mechanism
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1548.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1220.html">
     T1220 - XSL Script Processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1220.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.002.html">
     T1134.002 - Create Process with Token
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.004.html">
     T1055.004 - Process Injection: Asynchronous Procedure Call
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1578.001.html">
     T1578.001 - Create Snapshot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1140.html">
     T1140 - Deobfuscate/Decode Files or Information
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1140.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.007.html">
     T1218.007 - Signed Binary Proxy Execution: Msiexec
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.006.html">
     T1036.006 - Masquerading: Space after Filename
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.004.html">
     T1036.004 - Masquerade Task or Service
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.html">
     T1027 - Obfuscated Files or Information
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1027.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1553.html">
     T1553 - Subvert Trust Controls
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1553.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1480.001.html">
     T1480.001 - Environmental Keying
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.005.html">
     T1218.005 - Signed Binary Proxy Execution: Mshta
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1553.004.html">
     T1553.004 - Subvert Trust Controls: Install Root Certificate
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.002.html">
     T1574.002 - Hijack Execution Flow: DLL Side-Loading
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1222.html">
     T1222 - File and Directory Permissions Modification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1222.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1578.003.html">
     T1578.003 - Delete Cloud Instance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.html">
     T1497 - Virtualization/Sandbox Evasion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.003.html">
     T1036.003 - Masquerading: Rename System Utilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.002.html">
     T1218.002 - Signed Binary Proxy Execution: Control Panel
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     T1553.003 - SIP and Trust Provider Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.001.html">
     T1055.001 - Dynamic-link Library Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.005.html">
     T1574.005 - Executable Installer File Permissions Weakness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1578.004.html">
     T1578.004 - Revert Cloud Instance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1535.html">
     T1535 - Unused/Unsupported Cloud Regions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1535.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.html">
     T1218 - Signed Binary Proxy Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1006.html">
     T1006 - Direct Volume Access
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1006.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1553.001.html">
     T1553.001 - Subvert Trust Controls: Gatekeeper Bypass
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.003.html">
     T1055.003 - Thread Execution Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.007.html">
     T1574.007 - Path Interception by PATH Environment Variable
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.005.html">
     T1134.005 - SID-History Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.002.html">
     T1078.002 - Domain Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.001.html">
     T1036.001 - Invalid Code Signature
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1556.html">
     T1556 - Modify Authentication Process
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1556.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1207.html">
     T1207 - Rogue Domain Controller
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1207.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1218.004.html">
     T1218.004 - Signed Binary Proxy Execution: InstallUtil
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1036.005.html">
     T1036.005 - Match Legitimate Name or Location
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1578.002.html">
     T1578.002 - Create Cloud Instance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.001.html">
     T1134.001 - Token Impersonation/Theft
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.html">
     T1078 - Valid Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1221.html">
     T1221 - Template Injection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1221.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1134.003.html">
     T1134.003 - Make and Impersonate Token
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1055.005.html">
     T1055.005 - Thread Local Storage
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.001.html">
     T1574.001 - Hijack Execution Flow: DLL Search Order Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.html">
     T1574 - Hijack Execution Flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1574.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1550.html">
     T1550 - Use Alternate Authentication Material
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1550.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1078.004.html">
     T1078.004 - Cloud Accounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1205.html">
     T1205 - Traffic Signaling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1205.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../credential-access.html">
   Credential Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../discovery.html">
   Discovery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lateral-movement.html">
   Lateral Movement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../collection.html">
   Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../command-and-control.html">
   Command and Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exfiltration.html">
   Exfiltration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../impact.html">
   Impact
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/tactics/defense-evasion/T1553.003.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atomic-tests">
   Atomic Tests:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detection">
   Detection
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="t1553-003-sip-and-trust-provider-hijacking">
<h1>T1553.003 - SIP and Trust Provider Hijacking<a class="headerlink" href="#t1553-003-sip-and-trust-provider-hijacking" title="Permalink to this headline">¶</a></h1>
<p>Adversaries may tamper with SIP and trust provider components to mislead the operating system and application control tools when conducting signature validation checks. In user mode, Windows Authenticode (Citation: Microsoft Authenticode) digital signatures are used to verify a file’s origin and integrity, variables that may be used to establish trust in signed code (ex: a driver with a valid Microsoft signature may be handled as safe). The signature validation process is handled via the WinVerifyTrust application programming interface (API) function,  (Citation: Microsoft WinVerifyTrust) which accepts an inquiry and coordinates with the appropriate trust provider, which is responsible for validating parameters of a signature. (Citation: SpectorOps Subverting Trust Sept 2017)</p>
<p>Because of the varying executable file types and corresponding signature formats, Microsoft created software components called Subject Interface Packages (SIPs) (Citation: EduardosBlog SIPs July 2008) to provide a layer of abstraction between API functions and files. SIPs are responsible for enabling API functions to create, retrieve, calculate, and verify signatures. Unique SIPs exist for most file formats (Executable, PowerShell, Installer, etc., with catalog signing providing a catch-all  (Citation: Microsoft Catalog Files and Signatures April 2017)) and are identified by globally unique identifiers (GUIDs). (Citation: SpectorOps Subverting Trust Sept 2017)</p>
<p>Similar to <a class="reference external" href="https://attack.mitre.org/techniques/T1116">Code Signing</a>, adversaries may abuse this architecture to subvert trust controls and bypass security policies that allow only legitimately signed code to execute on a system. Adversaries may hijack SIP and trust provider components to mislead operating system and application control tools to classify malicious (or any) code as signed by: (Citation: SpectorOps Subverting Trust Sept 2017)</p>
<ul class="simple">
<li><p>Modifying the <code>Dll</code> and <code>FuncName</code> Registry values in <code>HKLM\SOFTWARE[\WOW6432Node]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllGetSignedDataMsg{SIP_GUID}</code> that point to the dynamic link library (DLL) providing a SIP’s CryptSIPDllGetSignedDataMsg function, which retrieves an encoded digital certificate from a signed file. By pointing to a maliciously-crafted DLL with an exported function that always returns a known good signature value (ex: a Microsoft signature for Portable Executables) rather than the file’s real signature, an adversary can apply an acceptable signature value to all files using that SIP (Citation: GitHub SIP POC Sept 2017) (although a hash mismatch will likely occur, invalidating the signature, since the hash returned by the function will not match the value computed from the file).</p></li>
<li><p>Modifying the <code>Dll</code> and <code>FuncName</code> Registry values in <code>HKLM\SOFTWARE[WOW6432Node]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllVerifyIndirectData{SIP_GUID}</code> that point to the DLL providing a SIP’s CryptSIPDllVerifyIndirectData function, which validates a file’s computed hash against the signed hash value. By pointing to a maliciously-crafted DLL with an exported function that always returns TRUE (indicating that the validation was successful), an adversary can successfully validate any file (with a legitimate signature) using that SIP (Citation: GitHub SIP POC Sept 2017) (with or without hijacking the previously mentioned CryptSIPDllGetSignedDataMsg function). This Registry value could also be redirected to a suitable exported function from an already present DLL, avoiding the requirement to drop and execute a new file on disk.</p></li>
<li><p>Modifying the <code>DLL</code> and <code>Function</code> Registry values in <code>HKLM\SOFTWARE[WOW6432Node]Microsoft\Cryptography\Providers\Trust\FinalPolicy{trust provider GUID}</code> that point to the DLL providing a trust provider’s FinalPolicy function, which is where the decoded and parsed signature is checked and the majority of trust decisions are made. Similar to hijacking SIP’s CryptSIPDllVerifyIndirectData function, this value can be redirected to a suitable exported function from an already present DLL or a maliciously-crafted DLL (though the implementation of a trust provider is complex).</p></li>
<li><p><strong>Note:</strong> The above hijacks are also possible without modifying the Registry via <a class="reference external" href="https://attack.mitre.org/techniques/T1038">DLL Search Order Hijacking</a>.</p></li>
</ul>
<p>Hijacking SIP or trust provider components can also enable persistent code execution, since these malicious components may be invoked by any application that performs code signing or signature validation. (Citation: SpectorOps Subverting Trust Sept 2017)</p>
<div class="section" id="atomic-tests">
<h2>Atomic Tests:<a class="headerlink" href="#atomic-tests" title="Permalink to this headline">¶</a></h2>
<p>Currently, no tests are available for this technique.</p>
</div>
<div class="section" id="detection">
<h2>Detection<a class="headerlink" href="#detection" title="Permalink to this headline">¶</a></h2>
<p>Periodically baseline registered SIPs and trust providers (Registry entries and files on disk), specifically looking for new, modified, or non-Microsoft entries. (Citation: SpectorOps Subverting Trust Sept 2017)</p>
<p>Enable CryptoAPI v2 (CAPI) event logging (Citation: Entrust Enable CAPI2 Aug 2017) to monitor and analyze error events related to failed trust validation (Event ID 81, though this event can be subverted by hijacked trust provider components) as well as any other provided information events (ex: successful validations). Code Integrity event logging may also provide valuable indicators of malicious SIP or trust provider loads, since protected processes that attempt to load a maliciously-crafted trust validation component will likely fail (Event ID 3033). (Citation: SpectorOps Subverting Trust Sept 2017)</p>
<p>Utilize Sysmon detection rules and/or enable the Registry (Global Object Access Auditing) (Citation: Microsoft Registry Auditing Aug 2016) setting in the Advanced Security Audit policy to apply a global system access control list (SACL) and event auditing on modifications to Registry values (sub)keys related to SIPs and trust providers: (Citation: Microsoft Audit Registry July 2012)</p>
<ul class="simple">
<li><p>HKLM\SOFTWARE\Microsoft\Cryptography\OID</p></li>
<li><p>HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\OID</p></li>
<li><p>HKLM\SOFTWARE\Microsoft\Cryptography\Providers\Trust</p></li>
<li><p>HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\Providers\Trust</p></li>
</ul>
<p><strong>Note:</strong> As part of this technique, adversaries may attempt to manually edit these Registry keys (ex: Regedit) or utilize the legitimate registration process using <a class="reference external" href="https://attack.mitre.org/techniques/T1117">Regsvr32</a>. (Citation: SpectorOps Subverting Trust Sept 2017)</p>
<p>Analyze Autoruns data for oddities and anomalies, specifically malicious files attempting persistent execution by hiding within auto-starting locations. Autoruns will hide entries signed by Microsoft or Windows by default, so ensure “Hide Microsoft Entries” and “Hide Windows Entries” are both deselected. (Citation: SpectorOps Subverting Trust Sept 2017)</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ".net-powershell"
        },
        kernelOptions: {
            kernelName: ".net-powershell",
            path: "./tactics/defense-evasion"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = '.net-powershell'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="T1218.002.html" title="previous page">T1218.002 - Signed Binary Proxy Execution: Control Panel</a>
    <a class='right-next' id="next-link" href="T1055.001.html" title="next page">T1055.001 - Dynamic-link Library Injection</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hare Sudhan Muthusamy<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>