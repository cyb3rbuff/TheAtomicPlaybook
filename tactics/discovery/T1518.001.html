

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>T1518.001 - Software Discovery: Security Software Discovery &#8212; The Atomic Playbook</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="T1082 - System Information Discovery" href="T1082.html" />
    <link rel="prev" title="T1497.001 - System Checks" href="T1497.001.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">The Atomic Playbook</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to the Atomic Playbook
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../initial-access.html">
   Initial Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../execution.html">
   Execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../persistence.html">
   Persistence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../privilege-escalation.html">
   Privilege Escalation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../defense-evasion.html">
   Defense Evasion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../credential-access.html">
   Credential Access
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../discovery.html">
   Discovery
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="T1135.html">
     T1135 - Network Share Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1135.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1049.html">
     T1049 - System Network Connections Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1049.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1033.html">
     T1033 - System Owner/User Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1033.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1087.002.html">
     T1087.002 - Account Discovery: Domain Account
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1526.html">
     T1526 - Cloud Service Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1526.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.002.html">
     T1497.002 - User Activity Based Checks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1087.004.html">
     T1087.004 - Cloud Account
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1069.002.html">
     T1069.002 - Permission Groups Discovery: Domain Groups
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1069.html">
     T1069 - Permission Groups Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1069.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1016.html">
     T1016 - System Network Configuration Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1016.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1482.html">
     T1482 - Domain Trust Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1482.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1087.003.html">
     T1087.003 - Email Account
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1518.html">
     T1518 - Software Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1518.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1087.001.html">
     T1087.001 - Account Discovery: Local Account
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.003.html">
     T1497.003 - Time Based Evasion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1538.html">
     T1538 - Cloud Service Dashboard
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1538.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1010.html">
     T1010 - Application Window Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1010.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1069.003.html">
     T1069.003 - Cloud Groups
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1012.html">
     T1012 - Query Registry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1012.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1057.html">
     T1057 - Process Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1057.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1069.001.html">
     T1069.001 - Permission Groups Discovery: Local Groups
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1217.html">
     T1217 - Browser Bookmark Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1217.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.001.html">
     T1497.001 - System Checks
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     T1518.001 - Software Discovery: Security Software Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1082.html">
     T1082 - System Information Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1082.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1007.html">
     T1007 - System Service Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1007.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1040.html">
     T1040 - Network Sniffing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1040.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1018.html">
     T1018 - Remote System Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1018.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1046.html">
     T1046 - Network Service Scanning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1046.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.html">
     T1497 - Virtualization/Sandbox Evasion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1497.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1201.html">
     T1201 - Password Policy Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1201.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1124.html">
     T1124 - System Time Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1124.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1083.html">
     T1083 - File and Directory Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1083.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1087.html">
     T1087 - Account Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1087.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1120.html">
     T1120 - Peripheral Device Discovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1120.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lateral-movement.html">
   Lateral Movement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../collection.html">
   Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../command-and-control.html">
   Command and Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exfiltration.html">
   Exfiltration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../impact.html">
   Impact
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/tactics/discovery/T1518.001.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atomic-tests">
   Atomic Tests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-1-security-software-discovery">
     Atomic Test #1 - Security Software Discovery
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-command-prompt">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         command_prompt
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-2-security-software-discovery-powershell">
     Atomic Test #2 - Security Software Discovery - powershell
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-powershell">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-3-security-software-discovery-ps">
     Atomic Test #3 - Security Software Discovery - ps
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-sh">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         sh
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-4-security-software-discovery-sysmon-service">
     Atomic Test #4 - Security Software Discovery - Sysmon Service
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         command_prompt
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-5-security-software-discovery-av-discovery-via-wmi">
     Atomic Test #5 - Security Software Discovery - AV Discovery via WMI
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         command_prompt
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detection">
   Detection
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="t1518-001-software-discovery-security-software-discovery">
<h1>T1518.001 - Software Discovery: Security Software Discovery<a class="headerlink" href="#t1518-001-software-discovery-security-software-discovery" title="Permalink to this headline">¶</a></h1>
<p>Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as firewall rules and anti-virus. Adversaries may use the information from <a class="reference external" href="https://attack.mitre.org/techniques/T1518/001">Security Software Discovery</a> during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.</p>
<p>Example commands that can be used to obtain security software information are <a class="reference external" href="https://attack.mitre.org/software/S0108">netsh</a>, <code>reg query</code> with <a class="reference external" href="https://attack.mitre.org/software/S0075">Reg</a>, <code>dir</code> with <a class="reference external" href="https://attack.mitre.org/software/S0106">cmd</a>, and <a class="reference external" href="https://attack.mitre.org/software/S0057">Tasklist</a>, but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for. It is becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software.</p>
<p>Adversaries may also utilize cloud APIs to discover the configurations of firewall rules within an environment.(Citation: Expel IO Evil in AWS)</p>
<div class="section" id="atomic-tests">
<h2>Atomic Tests<a class="headerlink" href="#atomic-tests" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the Module before running the tests.</span>
<span class="c1"># Checkout Jupyter Notebook at https://github.com/haresudhan/TheAtomicPlaybook to run PS scripts.</span>
<span class="n">Import</span><span class="o">-</span><span class="n">Module</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="mh">0x6c</span><span class="o">/</span><span class="n">AtomicRedTeam</span><span class="o">/</span><span class="n">atomics</span><span class="o">/</span><span class="n">invoke</span><span class="o">-</span><span class="n">atomicredteam</span><span class="o">/</span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicRedTeam</span><span class="o">.</span><span class="n">psd1</span> <span class="o">-</span> <span class="n">Force</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="atomic-test-1-security-software-discovery">
<h3>Atomic Test #1 - Security Software Discovery<a class="headerlink" href="#atomic-test-1-security-software-discovery" title="Permalink to this headline">¶</a></h3>
<p>Methods to identify Security Software on an endpoint</p>
<p>when sucessfully executed, the test is going to display running processes, firewall configuration on network profiles
and specific security software.</p>
<p><strong>Supported Platforms:</strong> windows</p>
<div class="section" id="attack-commands-run-with-command-prompt">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code><a class="headerlink" href="#attack-commands-run-with-command-prompt" title="Permalink to this headline">¶</a></h4>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>netsh.exe advfirewall  show allprofiles
tasklist.exe
tasklist.exe | findstr /i virus
tasklist.exe | findstr /i cb
tasklist.exe | findstr /i defender
tasklist.exe | findstr /i cylance
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1518</span><span class="o">.</span><span class="mi">001</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-2-security-software-discovery-powershell">
<h3>Atomic Test #2 - Security Software Discovery - powershell<a class="headerlink" href="#atomic-test-2-security-software-discovery-powershell" title="Permalink to this headline">¶</a></h3>
<p>Methods to identify Security Software on an endpoint</p>
<p>when sucessfully executed, powershell is going to processes related AV products if they are running.</p>
<p><strong>Supported Platforms:</strong> windows</p>
<div class="section" id="attack-commands-run-with-powershell">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#attack-commands-run-with-powershell" title="Permalink to this headline">¶</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">get-process</span> <span class="p">|</span> <span class="p">?{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Description</span> <span class="o">-like</span> <span class="s2">&quot;*virus*&quot;</span><span class="p">}</span>
<span class="nb">get-process</span> <span class="p">|</span> <span class="p">?{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Description</span> <span class="o">-like</span> <span class="s2">&quot;*carbonblack*&quot;</span><span class="p">}</span>
<span class="nb">get-process</span> <span class="p">|</span> <span class="p">?{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Description</span> <span class="o">-like</span> <span class="s2">&quot;*defender*&quot;</span><span class="p">}</span>
<span class="nb">get-process</span> <span class="p">|</span> <span class="p">?{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Description</span> <span class="o">-like</span> <span class="s2">&quot;*cylance*&quot;</span><span class="p">}</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1518</span><span class="o">.</span><span class="mi">001</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-3-security-software-discovery-ps">
<h3>Atomic Test #3 - Security Software Discovery - ps<a class="headerlink" href="#atomic-test-3-security-software-discovery-ps" title="Permalink to this headline">¶</a></h3>
<p>Methods to identify Security Software on an endpoint
when sucessfully executed, command shell  is going to display AV software it is running( Little snitch or carbon black ).</p>
<p><strong>Supported Platforms:</strong> linux, macos</p>
<div class="section" id="attack-commands-run-with-sh">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">sh</span></code><a class="headerlink" href="#attack-commands-run-with-sh" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ps -ef <span class="p">|</span> grep Little<span class="se">\ </span>Snitch <span class="p">|</span> grep -v grep
ps aux <span class="p">|</span> grep CbOsxSensorService
ps aux <span class="p">|</span> grep falcond
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1518</span><span class="o">.</span><span class="mi">001</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-4-security-software-discovery-sysmon-service">
<h3>Atomic Test #4 - Security Software Discovery - Sysmon Service<a class="headerlink" href="#atomic-test-4-security-software-discovery-sysmon-service" title="Permalink to this headline">¶</a></h3>
<p>Discovery of an installed Sysinternals Sysmon service using driver altitude (even if the name is changed).</p>
<p>when sucessfully executed, the test is going to display sysmon driver instance if it is installed.</p>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)</p>
<div class="section" id="id1">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>fltmc.exe | findstr.exe 385201
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1518</span><span class="o">.</span><span class="mi">001</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-5-security-software-discovery-av-discovery-via-wmi">
<h3>Atomic Test #5 - Security Software Discovery - AV Discovery via WMI<a class="headerlink" href="#atomic-test-5-security-software-discovery-av-discovery-via-wmi" title="Permalink to this headline">¶</a></h3>
<p>Discovery of installed antivirus products via a WMI query.</p>
<p>when sucessfully executed, the test is going to display installed AV software.</p>
<p><strong>Supported Platforms:</strong> windows
Elevation Required (e.g. root or admin)</p>
<div class="section" id="id2">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">command_prompt</span></code><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-command_prompt notranslate"><div class="highlight"><pre><span></span>wmic.exe /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List```
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1518</span><span class="o">.</span><span class="mi">001</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="detection">
<h2>Detection<a class="headerlink" href="#detection" title="Permalink to this headline">¶</a></h2>
<p>System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained.</p>
<p>Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as <a class="reference external" href="https://attack.mitre.org/techniques/T1047">Windows Management Instrumentation</a> and <a class="reference external" href="https://attack.mitre.org/techniques/T1059/001">PowerShell</a>.</p>
<p>In cloud environments, additionally monitor logs for the usage of APIs that may be used to gather information about security software configurations within the environment.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ".net-powershell"
        },
        kernelOptions: {
            kernelName: ".net-powershell",
            path: "./tactics/discovery"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = '.net-powershell'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="T1497.001.html" title="previous page">T1497.001 - System Checks</a>
    <a class='right-next' id="next-link" href="T1082.html" title="next page">T1082 - System Information Discovery</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hare Sudhan Muthusamy<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>