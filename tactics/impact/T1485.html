

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>T1485 - Data Destruction &#8212; The Atomic Playbook</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="T1491.001 - Internal Defacement" href="T1491.001.html" />
    <link rel="prev" title="T1565 - Data Manipulation" href="T1565.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">The Atomic Playbook</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to the Atomic Playbook
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../initial-access.html">
   Initial Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../execution.html">
   Execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../persistence.html">
   Persistence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../privilege-escalation.html">
   Privilege Escalation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../defense-evasion.html">
   Defense Evasion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../credential-access.html">
   Credential Access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../discovery.html">
   Discovery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lateral-movement.html">
   Lateral Movement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../collection.html">
   Collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../command-and-control.html">
   Command and Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exfiltration.html">
   Exfiltration
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../impact.html">
   Impact
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="T1561.html">
     T1561 - Disk Wipe
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1561.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1498.html">
     T1498 - Network Denial of Service
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1498.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1565.003.html">
     T1565.003 - Runtime Data Manipulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1565.001.html">
     T1565.001 - Stored Data Manipulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1491.002.html">
     T1491.002 - External Defacement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1565.html">
     T1565 - Data Manipulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1565.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     T1485 - Data Destruction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1491.001.html">
     T1491.001 - Internal Defacement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1565.002.html">
     T1565.002 - Transmitted Data Manipulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1499.html">
     T1499 - Endpoint Denial of Service
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1499.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1486.html">
     T1486 - Data Encrypted for Impact
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1486.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1491.html">
     T1491 - Defacement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1491.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1495.html">
     T1495 - Firmware Corruption
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1495.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1499.001.html">
     T1499.001 - OS Exhaustion Flood
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1529.html">
     T1529 - System Shutdown/Reboot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1529.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1498.002.html">
     T1498.002 - Reflection Amplification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1561.001.html">
     T1561.001 - Disk Content Wipe
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1499.003.html">
     T1499.003 - Application Exhaustion Flood
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1489.html">
     T1489 - Service Stop
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1489.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1490.html">
     T1490 - Inhibit System Recovery
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1490.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1499.004.html">
     T1499.004 - Application or System Exploitation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1498.001.html">
     T1498.001 - Direct Network Flood
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1499.002.html">
     T1499.002 - Service Exhaustion Flood
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1496.html">
     T1496 - Resource Hijacking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1496.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1531.html">
     T1531 - Account Access Removal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1531.html#shield-active-defense">
     Shield Active Defense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T1561.002.html">
     T1561.002 - Disk Structure Wipe
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/tactics/impact/T1485.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atomic-tests">
   Atomic Tests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-1-windows-overwrite-file-with-sysinternals-sdelete">
     Atomic Test #1 - Windows - Overwrite file with Sysinternals SDelete
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dependencies-run-with-powershell">
       Dependencies:  Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
       !
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#description-secure-delete-tool-from-sysinternals-must-exist-on-disk-at-specified-location-sdelete-exe">
         Description: Secure delete tool from Sysinternals must exist on disk at specified location (#{sdelete_exe})
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#check-prereq-commands">
         Check Prereq Commands:
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#get-prereq-commands">
         Get Prereq Commands:
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#description-the-file-to-delete-must-exist-at-file-to-delete">
         Description: The file to delete must exist at #{file_to_delete}
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id1">
         Check Prereq Commands:
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id2">
         Get Prereq Commands:
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-powershell">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         powershell
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atomic-test-2-macos-linux-overwrite-file-with-dd">
     Atomic Test #2 - macOS/Linux - Overwrite file with DD
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attack-commands-run-with-bash">
       Attack Commands: Run with
       <code class="docutils literal notranslate">
        <span class="pre">
         bash
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detection">
   Detection
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="t1485-data-destruction">
<h1>T1485 - Data Destruction<a class="headerlink" href="#t1485-data-destruction" title="Permalink to this headline">¶</a></h1>
<p>Adversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems, services, and network resources. Data destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018)(Citation: Talos Olympic Destroyer 2018) Common operating system file deletion commands such as <code>del</code> and <code>rm</code> often only remove pointers to files without wiping the contents of the files themselves, making the files recoverable by proper forensic methodology. This behavior is distinct from <a class="reference external" href="https://attack.mitre.org/techniques/T1561/001">Disk Content Wipe</a> and <a class="reference external" href="https://attack.mitre.org/techniques/T1561/002">Disk Structure Wipe</a> because individual files are destroyed rather than sections of a storage disk or the disk’s logical structure.</p>
<p>Adversaries may attempt to overwrite files and directories with randomly generated data to make it irrecoverable.(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018) In some cases politically oriented image files have been used to overwrite data.(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)</p>
<p>To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware designed for destroying data may have worm-like features to propagate across a network by leveraging additional techniques like <a class="reference external" href="https://attack.mitre.org/techniques/T1078">Valid Accounts</a>, <a class="reference external" href="https://attack.mitre.org/techniques/T1003">OS Credential Dumping</a>, and <a class="reference external" href="https://attack.mitre.org/techniques/T1021/002">SMB/Windows Admin Shares</a>.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Talos Olympic Destroyer 2018)</p>
<div class="section" id="atomic-tests">
<h2>Atomic Tests<a class="headerlink" href="#atomic-tests" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Import the Module before running the tests.</span>
<span class="c1"># Checkout Jupyter Notebook at https://github.com/haresudhan/TheAtomicPlaybook to run PS scripts.</span>
<span class="n">Import</span><span class="o">-</span><span class="n">Module</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="mh">0x6c</span><span class="o">/</span><span class="n">AtomicRedTeam</span><span class="o">/</span><span class="n">atomics</span><span class="o">/</span><span class="n">invoke</span><span class="o">-</span><span class="n">atomicredteam</span><span class="o">/</span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicRedTeam</span><span class="o">.</span><span class="n">psd1</span> <span class="o">-</span> <span class="n">Force</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="atomic-test-1-windows-overwrite-file-with-sysinternals-sdelete">
<h3>Atomic Test #1 - Windows - Overwrite file with Sysinternals SDelete<a class="headerlink" href="#atomic-test-1-windows-overwrite-file-with-sysinternals-sdelete" title="Permalink to this headline">¶</a></h3>
<p>Overwrites and deletes a file using Sysinternals SDelete. Upon successful execution, “Files deleted: 1” will be displayed in
the powershell session along with other information about the file that was deleted.</p>
<p><strong>Supported Platforms:</strong> windows</p>
<div class="section" id="dependencies-run-with-powershell">
<h4>Dependencies:  Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code>!<a class="headerlink" href="#dependencies-run-with-powershell" title="Permalink to this headline">¶</a></h4>
<div class="section" id="description-secure-delete-tool-from-sysinternals-must-exist-on-disk-at-specified-location-sdelete-exe">
<h5>Description: Secure delete tool from Sysinternals must exist on disk at specified location (#{sdelete_exe})<a class="headerlink" href="#description-secure-delete-tool-from-sysinternals-must-exist-on-disk-at-specified-location-sdelete-exe" title="Permalink to this headline">¶</a></h5>
</div>
<div class="section" id="check-prereq-commands">
<h5>Check Prereq Commands:<a class="headerlink" href="#check-prereq-commands" title="Permalink to this headline">¶</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="nv">$env:TEMP</span><span class="p">\</span><span class="n">Sdelete</span><span class="p">\</span><span class="n">sdelete</span><span class="p">.</span><span class="n">exe</span><span class="p">)</span> <span class="p">{</span><span class="n">exit</span> <span class="n">0</span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span><span class="n">exit</span> <span class="n">1</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="get-prereq-commands">
<h5>Get Prereq Commands:<a class="headerlink" href="#get-prereq-commands" title="Permalink to this headline">¶</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-WebRequest</span> <span class="s2">&quot;https://download.sysinternals.com/files/SDelete.zip&quot;</span> <span class="n">-OutFile</span> <span class="s2">&quot;$env:TEMP\SDelete.zip&quot;</span>
<span class="nb">Expand-Archive</span> <span class="nv">$env:TEMP</span><span class="p">\</span><span class="n">SDelete</span><span class="p">.</span><span class="n">zip</span> <span class="nv">$env:TEMP</span><span class="p">\</span><span class="n">Sdelete</span> <span class="n">-Force</span>
<span class="nb">Remove-Item</span> <span class="nv">$env:TEMP</span><span class="p">\</span><span class="n">SDelete</span><span class="p">.</span><span class="n">zip</span> <span class="n">-Force</span>
</pre></div>
</div>
</div>
<div class="section" id="description-the-file-to-delete-must-exist-at-file-to-delete">
<h5>Description: The file to delete must exist at #{file_to_delete}<a class="headerlink" href="#description-the-file-to-delete-must-exist-at-file-to-delete" title="Permalink to this headline">¶</a></h5>
</div>
<div class="section" id="id1">
<h5>Check Prereq Commands:<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="nv">$env:TEMP</span><span class="p">\</span><span class="n">T1485</span><span class="p">.</span><span class="n">txt</span><span class="p">)</span> <span class="p">{</span> <span class="n">exit</span> <span class="n">0</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="n">exit</span> <span class="n">1</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h5>Get Prereq Commands:<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">New-Item</span> <span class="nv">$env:TEMP</span><span class="p">\</span><span class="n">T1485</span><span class="p">.</span><span class="n">txt</span> <span class="n">-Force</span> <span class="p">|</span> <span class="nb">Out-Null</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1485</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">1</span> <span class="o">-</span><span class="n">GetPreReqs</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="attack-commands-run-with-powershell">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">powershell</span></code><a class="headerlink" href="#attack-commands-run-with-powershell" title="Permalink to this headline">¶</a></h4>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Invoke-Expression</span> <span class="n">-Command</span> <span class="s2">&quot;$env:TEMP\Sdelete\sdelete.exe -accepteula $env:TEMP\T1485.txt&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1485</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="atomic-test-2-macos-linux-overwrite-file-with-dd">
<h3>Atomic Test #2 - macOS/Linux - Overwrite file with DD<a class="headerlink" href="#atomic-test-2-macos-linux-overwrite-file-with-dd" title="Permalink to this headline">¶</a></h3>
<p>Overwrites and deletes a file using DD.
To stop the test, break the command with CTRL/CMD+C.</p>
<p><strong>Supported Platforms:</strong> linux, macos</p>
<div class="section" id="attack-commands-run-with-bash">
<h4>Attack Commands: Run with <code class="docutils literal notranslate"><span class="pre">bash</span></code><a class="headerlink" href="#attack-commands-run-with-bash" title="Permalink to this headline">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dd <span class="nv">of</span><span class="o">=</span>/var/log/syslog <span class="k">if</span><span class="o">=</span>/dev/zero
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Invoke</span><span class="o">-</span><span class="n">AtomicTest</span> <span class="n">T1485</span> <span class="o">-</span><span class="n">TestNumbers</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="detection">
<h2>Detection<a class="headerlink" href="#detection" title="Permalink to this headline">¶</a></h2>
<p>Use process monitoring to monitor the execution and command-line parameters of binaries that could be involved in data destruction activity, such as <a class="reference external" href="https://attack.mitre.org/software/S0195">SDelete</a>. Monitor for the creation of suspicious files as well as high unusual file modification activity. In particular, look for large quantities of file modifications in user directories and under <code>C:\Windows\System32&lt;/code&gt;.</p>
</div>
</div>
<div class="section" id="shield-active-defense">
<h1>Shield Active Defense<a class="headerlink" href="#shield-active-defense" title="Permalink to this headline">¶</a></h1>
<div class="section" id="backup-and-recovery">
<h2>Backup and Recovery<a class="headerlink" href="#backup-and-recovery" title="Permalink to this headline">¶</a></h2>
<p>Make copies of key system software, configuration, and data to enable rapid system restoration.</p>
<p>Employ disk imaging, system backup, or file synchronization tools to create copies of key data on a protected backup repository.  This is typically done to capture/restore an entire system or major subsystems.</p>
<div class="section" id="opportunity">
<h3>Opportunity<a class="headerlink" href="#opportunity" title="Permalink to this headline">¶</a></h3>
<p>There is an opportunity to test what an adversary might do if destroyed data is selectively replaced by the defender.</p>
</div>
<div class="section" id="use-case">
<h3>Use Case<a class="headerlink" href="#use-case" title="Permalink to this headline">¶</a></h3>
<p>A defender can ensure data is backed up on a regular basis and backups are stored offline from the system.  If an adversary is detected destroying or altering data, the defender could selectively restore data from backup to see how the adversary reacts.</p>
</div>
<div class="section" id="procedures">
<h3>Procedures<a class="headerlink" href="#procedures" title="Permalink to this headline">¶</a></h3>
<p>Backup data on public facing websites and retain the files offline. In the event of data damage or loss, restore the data from backup.
Backup data on an end-user system and store offline.  If an adversary alters or deletes data on the system, restore the data using the backup copy.
In an adversary engagement situation, if an adversary deletes or alters files on a machine they are controlling, restore the data to it original state and location to see how the adversary reacts.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ".net-powershell"
        },
        kernelOptions: {
            kernelName: ".net-powershell",
            path: "./tactics/impact"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = '.net-powershell'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="T1565.html" title="previous page">T1565 - Data Manipulation</a>
    <a class='right-next' id="next-link" href="T1491.001.html" title="next page">T1491.001 - Internal Defacement</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hare Sudhan Muthusamy<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>